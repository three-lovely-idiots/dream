{include file="public/pointmallheader" /}
<style>
    table {
        table-layout: fixed;
    }

    th {
        text-align: center;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    td {
        text-align: center;
    }

    .ellipsis {
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    td.nowrap {
        white-space: nowrap;
        overflow: hidden;
    }

    .goods-pic {
        width: 3rem;
        height: 3rem;
        display: inline-block;
        background-color: #ddd;
        background-size: cover;
        background-position: center;
    }
</style>
<div class="panel mb-3">
    <div class="panel-header">{$title}</div>
    <div class="panel-body">
        <div class="mb-3 clearfix">
            <div class="float-left">
                <a href="./catEdit" class="btn btn-primary"><i
                        class="iconfont icon-playlistadd"></i>添加分类</a>
            </div>
        </div>
        <table id="cusTable" data-show-columns="false" data-show-toggle="false" class="table table-bordered bg-white">

            <!--<col style="width: 5%">-->
            <!--<col style="width: 10%">-->
            <!--<col style="width: 22%">-->
            <!--<col style="width: 5%">-->
            <!--<col style="width: 18%">-->

        </table>
    </div>
</div>

{include file="public/script" /}
<script type="text/javascript">
    function initTable() {
        var table = $('#cusTable');
        Table.init({
            extend: {
                index_url: './cat',
                add_url: './catEdit',
                edit_url: './catEdit',
                del_url: './catDel',
            }
        });
        //先销毁表格
        table.bootstrapTable('destroy');
        //初始化表格,动态从服务器加载数据
        table.bootstrapTable({
            url: $.fn.bootstrapTable.defaults.extend.index_url, //获取数据的地址
            sortName: 'id',
            columns: [ //这里可以单独拎出去
                [
                    {field: 'id', title: 'ID'},
                    {field: 'name', title: '分类名称'},
                    {field: 'pic_url', title: '图标',formatter: Table.formatter.product_thumb},
                    {field: 'sort', title: '排序'},
                    {
                        field: 'operate',
                        title: '操作',
                        table: table,
                        events: Table.events.operate,
                        formatter: Table.formatter.operate
                    }
                ]
            ],
        });

        Table.bindEvent(table)
    }
    $(document).ready(function () {
        //调用函数，初始化表格
        initTable();
    });
</script>
<script>
    $(document).on('click', '.del', function () {
        if (confirm("是否删除？")) {
            $.ajax({
                url: $(this).attr('href'),
                type: 'get',
                dataType: 'json',
                success: function (res) {
                    alert(res.msg);
                    if (res.code == 0) {
                        window.location.reload();
                    }
                }
            });
        }
        return false;
    });
</script>

</body>
</html>